<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Data Analysis with R - 18&nbsp; Scatter plots and smoothing lines</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./data_on_display_ls03_line_graphs.html" rel="next">
<link href="./data_on_display_ls01_gg_intro.html" rel="prev">
<link href="./logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/core-js-2.5.3/shim.min.js"></script>
<script src="site_libs/react-17.0.0/react.min.js"></script>
<script src="site_libs/react-17.0.0/react-dom.min.js"></script>
<script src="site_libs/reactwidget-1.0.0/react-tools.js"></script>
<script src="site_libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<link href="site_libs/reactable-0.4.3/reactable.css" rel="stylesheet">
<script src="site_libs/reactable-binding-0.4.3/reactable.js"></script>


<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data_on_display_ls01_gg_intro.html">Data Visualization</a></li><li class="breadcrumb-item"><a href="./data_on_display_ls02_scatter.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Scatter plots and smoothing lines</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Data Analysis with R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/the-graph-courses/idar_book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations_ls01_setting_up.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Setting up R and RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations_ls02_using_rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Using RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations_ls03_coding_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Coding basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations_ls04_data_dive_ebola_sierra_leone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data dive: Ebola in Sierra Leone</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations_ls05_projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">RStudio projects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations_ls06_rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">R Markdown</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations_ls07_data_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data structures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations_ls08_01_using_chatgpt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Using ChatGPT for Data Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Data Manipulation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./untangled_ls01_select_rename.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Selecting and renaming columns</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./untangled_ls02_filter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Filtering rows</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./untangled_ls03_mutate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Mutating columns</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./untangled_ls04_conditional_mutate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Conditional mutating</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./untangled_ls05_groupby_summarize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Grouping and summarizing data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./untangled_ls06_group_by_other_verbs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Grouped filter, mutate and arrange</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./untangled_ls07_pivoting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Pivoting data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./untangled_ls08_advanced_pivoting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Advanced pivoting</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Data Visualization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_on_display_ls01_gg_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Intro to ggplot2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_on_display_ls02_scatter.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Scatter plots and smoothing lines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_on_display_ls03_line_graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Lines, scales, and labels</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_on_display_ls04_histograms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Histograms with {ggplot2}</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_on_display_ls05_boxplots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Boxplots with {ggplot2}</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">18.1</span> Introduction</a></li>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives"><span class="header-section-number">18.2</span> Learning Objectives</a></li>
  <li><a href="#childhood-diarrheal-diseases-in-mali" id="toc-childhood-diarrheal-diseases-in-mali" class="nav-link" data-scroll-target="#childhood-diarrheal-diseases-in-mali"><span class="header-section-number">18.3</span> Childhood diarrheal diseases in Mali</a></li>
  <li><a href="#scatter-plots-via-geom_point" id="toc-scatter-plots-via-geom_point" class="nav-link" data-scroll-target="#scatter-plots-via-geom_point"><span class="header-section-number">18.4</span> Scatter plots via <code>geom_point()</code></a></li>
  <li><a href="#aesthetic-modifications" id="toc-aesthetic-modifications" class="nav-link" data-scroll-target="#aesthetic-modifications"><span class="header-section-number">18.5</span> Aesthetic modifications</a>
  <ul class="collapse">
  <li><a href="#mapping-data-to-aesthetics" id="toc-mapping-data-to-aesthetics" class="nav-link" data-scroll-target="#mapping-data-to-aesthetics"><span class="header-section-number">18.5.1</span> Mapping data to aesthetics</a></li>
  <li><a href="#setting-fixed-aesthetics" id="toc-setting-fixed-aesthetics" class="nav-link" data-scroll-target="#setting-fixed-aesthetics"><span class="header-section-number">18.5.2</span> Setting fixed aesthetics</a></li>
  </ul></li>
  <li><a href="#adding-a-trend-line" id="toc-adding-a-trend-line" class="nav-link" data-scroll-target="#adding-a-trend-line"><span class="header-section-number">18.6</span> Adding a trend line</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">18.7</span> Summary</a></li>
  <li><a href="#solutions" id="toc-solutions" class="nav-link" data-scroll-target="#solutions"><span class="header-section-number">18.8</span> Solutions</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/the-graph-courses/idar_book/edit/main/data_on_display_ls02_scatter.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/the-graph-courses/idar_book/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Scatter plots and smoothing lines</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introduction" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">18.1</span> Introduction</h2>
<p><strong>Scatter plots</strong> - which are sometimes called <strong>bivariate plots</strong> - allow you to visualize the <strong>relationship</strong> between two numerical variables.</p>
<p>They are among the most commonly used plots because they can provide an immediate way to see how one numerical variable varies against another.</p>
<p>Scatter plots can also display multiple relationships by mapping additional variable to aesthetic properties, such as color of the points.</p>
<p>Trends and relationships in a scatter plot can be made clearer by adding a smoothing line over the points.</p>
<p>We will use ggplot to do all that and more. Let’s get started!</p>
</section>
<section id="learning-objectives" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="learning-objectives"><span class="header-section-number">18.2</span> Learning Objectives</h2>
<ol type="1">
<li>You can visualize relationships between numerical variables using <strong>scatter plots</strong> with <strong><code>geom_point()</code></strong>.</li>
<li>You can use <strong><code>color</code></strong> as an aesthetic argument to map variables from the dataset onto individual points.</li>
<li>You can change the size, shape, color, fill, and opacity of geometric objects by setting <strong>fixed aesthetics</strong>.</li>
<li>You can add a <strong>trend line</strong> to a scatter plot with <strong><code>geom_smooth()</code></strong>.</li>
</ol>
</section>
<section id="childhood-diarrheal-diseases-in-mali" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="childhood-diarrheal-diseases-in-mali"><span class="header-section-number">18.3</span> Childhood diarrheal diseases in Mali</h2>
<p>We will be using data collected for a prospective observational study of acute <strong>diarrhea in children</strong> aged 0-59 months. The study was conducted in Mali and in early 2020.</p>
<p>The full dataset can be obtained from <a href="https://doi.org/10.5061/dryad.0rxwdbs19" target="_blank">Dryad</a>, and the paper can be viewed <a href="https://elifesciences.org/articles/72294" target="_blank">here</a>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Vocab">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Vocab
</div>
</div>
<div class="callout-body-container callout-body">
<p>A prospective study watches for outcomes, such as the development of a disease, during the study period and relates this to other factors such as suspected risk or protection factors.</p>
</div>
</div>
<p>Spend some time browsing through this dataset. Each row corresponds to one patient surveyed. There are demographic, physiological, clinical, socioeconomic, and geographic variables.</p>
<div class="cell">
<div class="cell-output-display">

<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-23ac2eb437e69f1efda5" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-23ac2eb437e69f1efda5">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"n":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150],"admit_date":["2020-01-16","2020-01-17","2020-01-17","2020-01-17","2020-01-21","2020-01-21","2020-01-22","2020-01-22","2020-01-17","2020-01-21","2020-01-22","2020-01-16","2020-01-16","2020-01-17","2020-01-21","2020-01-22","2020-01-23","2020-01-24","2020-01-27","2020-01-27","2020-01-27","2020-01-27","2020-01-27","2020-01-27","2020-01-28","2020-01-28","2020-01-28","2020-01-28","2020-01-28","2020-01-28","2020-01-29","2020-01-29","2020-01-30","2020-01-30","2020-01-30","2020-01-30","2020-01-30","2020-01-30","2020-01-31","2020-01-31","2020-01-31","2020-01-31","2020-03-02","2020-03-02","2020-03-02","2020-03-02","2020-03-02","2020-03-02","2020-04-02","2020-04-02","2020-04-02","2020-04-02","2020-05-02","2020-05-02","2020-05-02","2020-05-02","2020-05-02","2020-06-02","2020-06-02","2020-06-02","2020-06-02","2020-06-02","2020-06-02","2020-06-02","2020-06-02","2020-06-02","2020-06-02","2020-07-02","2020-07-02","2020-07-02","2020-07-02","2020-07-02","2020-07-02","2020-10-02","2020-10-02","2020-10-02","2020-10-02","2020-10-02","2020-10-02","2020-10-02","2020-11-02","2020-11-02","2020-11-02","2020-11-02","2020-11-02","2020-12-02","2020-12-02","2020-12-02","2020-12-02","2020-12-02","2020-12-02","2020-02-13","2020-02-13","2020-02-13","2020-02-13","2020-02-13","2020-02-14","2020-02-14","2020-02-14","2020-02-14","2020-02-17","2020-02-17","2020-02-17","2020-02-17","2020-02-17","2020-02-17","2020-02-17","2020-02-17","2020-02-17","2020-02-17","2020-02-17","2020-02-17","2020-02-18","2020-02-18","2020-02-18","2020-02-18","2020-02-18","2020-02-18","2020-02-19","2020-02-19","2020-02-19","2020-02-19","2020-02-19","2020-02-20","2020-02-20","2020-02-20","2020-02-20","2020-02-21","2020-02-21","2020-02-21","2020-02-21","2020-02-24","2020-02-24","2020-02-25","2020-02-25","2020-02-25","2020-02-26","2020-02-26","2020-02-26","2020-02-26","2020-02-26","2020-02-26","2020-02-26","2020-02-26","2020-02-27","2020-02-27","2020-02-27","2020-02-27","2020-02-28","2020-02-28"],"sex":["M","F","M","M","F","M","M","M","M","M","M","F","M","M","F","F","M","F","M","M","M","F","M","M","M","M","M","M","M","M","F","F","F","F","M","M","F","F","F","M","F","F","M","F","F","F","M","M","M","M","M","M","M","M","M","M","F","F","M","M","M","F","F","F","M","M","M","M","M","M","M","M","M","F","F","M","M","F","F","F","M","F","M","M","M","F","M","F","M","F","M","F","M","F","M","F","M","M","M","M","F","M","M","M","M","M","F","M","M","F","M","M","M","F","M","M","M","M","F","M","M","M","F","F","M","M","M","M","M","M","M","F","F","M","M","M","M","F","F","M","M","M","F","M","F","F","F","F","M","M"],"age_months":[5,12,11,9,16,6,5,46,4,25,3,10,17,14,16,9,10,16,4,1,3,2,3,3,24,9,3,15,13,8,18,19,31,1,10,5,16,42,31,6,7,10,2,9,16,14,36,2,8,6,11,15,3,23,8,12,16,8,4,20,15,18,7,8,10,9,2,8,13,6,15,8,9,6,10,3,24,8,15,48,9,3,1,8,11,6,8,11,6,9,25,16,3,2,3,13,10,30,21,8,9,16,6,0,14,5,13,11,24,9,9,5,6,6,4,10,27,7,21,11,2,43,5,8,6,11,6,12,2,9,9,14,7,5,11,12,12,9,3,3,18,18,10,12,22,7,5,5,4,18],"height_cm":[61.2,70.6,71.1,68.5,78.7,67.7,64.7,98.1,61.2,85.7,62.7,67.5,70.6,78.1,78.8,71,69,77.7,63.8,50.3,64.3,59.8,61,61.3,80.4,70,61.2,77.5,75.6,69.1,78.7,78,82.5,52.7,76.1,64.9,66.4,93.3,86.7,62.5,67.9,72.6,57.2,76.8,79.3,70.4,92.8,56.4,66.5,64.4,77.4,71,60.2,83.7,71.8,73,73.3,70.2,61.5,80.6,77.5,82,70.7,69.5,76.3,66.1,60.3,69.6,74.5,65.9,79.1,74.6,75.3,67.1,69.5,58.6,91.5,70.3,77.1,97.6,76,58.1,56.3,73.4,78.3,60.3,71.4,76,67.3,71.9,83.2,75.6,62.7,56.6,61.3,75.4,70.2,86.2,88,71.2,69.9,80.9,65,50.5,73.6,67,74.4,72,81.8,71.6,74.1,65.4,65.8,63.5,56.1,72.8,86.4,64.1,78.4,79.4,62.3,103.4,66.9,62.2,64.7,58.2,63,79.5,58.9,72.3,70.6,75.3,67.1,61.3,78.1,68,74.6,69.5,57.8,66.5,81.6,77,71.5,75.7,83.7,65.6,62,64.5,64.5,82.2],"muac_cm":[11.3,13.2,13.5,12.6,14.2,14.5,14.1,14.4,13.1,15,15.8,12,11,14.5,12,12.9,11.4,15.6,13.9,10.7,14,15.7,13.9,11.5,13.5,13.9,13.9,13.2,11.1,13.2,14.8,13.8,12.7,12.1,13.5,11.7,11.4,14.4,14.2,11.2,12.7,13.8,14.6,12.6,15.5,11.4,14.2,10.5,15.4,13.3,12.8,11.9,12.5,12.7,14.9,14.3,11.7,15.7,12.9,14,13.6,13.9,13.7,13.6,13,9.9,13.1,12.9,13.2,11.7,13.2,14.9,13.4,12.4,14,13.4,12.7,13.4,14.3,14.9,15.5,12.9,13,13.1,13.6,11.5,14.5,13.6,13.9,16,14.6,14.5,14.6,14.3,14,15.4,13.5,14.3,14.5,14.3,12.5,14.5,12.4,9.5,13.5,11.5,13.5,14,14.3,13.5,15.8,13.2,11.7,13.1,11.7,13.7,13.2,10.6,14.7,14.3,13.8,16.2,14.5,11.7,14.3,9.3,11.9,15.5,12.1,16,12.8,12.6,13.6,13.6,13.4,10.1,13.5,12,12,14.2,15.1,13.6,14.2,14.2,14,10.9,11.5,13.1,14.9,15.3],"breastfeeding":[1,1,1,1,1,1,1,0,1,0,1,1,0,1,1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,1,0,1,0,0,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0],"vomit":[0,1,1,0,1,0,0,1,0,1,0,1,1,1,1,1,1,0,0,0,0,0,0,1,0,0,1,1,1,0,1,1,1,0,1,1,1,0,0,0,1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,1,0,1,1,0,1,0,1,0,1,0,0,0,1,0,1,0,0,1,1,0,0,1,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,1,0,1,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0],"fever":[0,1,0,0,0,0,0,0,1,1,0,0,1,1,1,0,1,1,0,1,0,0,1,1,1,0,0,1,1,0,1,1,0,1,0,1,0,1,1,1,1,1,0,0,1,0,1,1,1,0,1,1,0,0,1,1,1,1,0,1,1,1,1,0,1,0,0,1,1,0,0,0,1,1,0,0,1,1,1,1,0,1,0,0,0,1,1,1,1,1,1,1,0,1,1,1,0,0,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,1,0,1,0,1,0,0,1,0,1,1,0,1,1,1,0,1,1,1,1,1,0],"bloody_stool":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"temp":[35.3,36.7,35.8,35.8,36.4,35.7,35.7,36,35.3,36,36.6,35.2,35.8,35.5,35.8,35.7,36.8,37.2,36.1,36.2,35.6,36,36.5,36.4,35.3,35.5,35.7,36.2,36,36.5,35.5,38.3,36.3,36.3,36,36,36,39.2,37.3,36.5,36.2,38.1,36.4,35.7,37.7,35.9,36,36.6,37.5,35.8,36.5,35.7,35.5,35.9,37.2,35.7,35.9,36.5,37,35.7,37.8,39.3,39,36.1,37.7,36.5,36.1,36.2,36.6,36.2,36.9,36.1,38.9,36.1,36.5,36.2,35.9,37.7,38.5,36.2,36.3,35.2,35.7,35.6,35.6,35.4,36.4,35.7,36.3,37,37.8,38,35.7,36.5,36,38.5,35.5,36.2,37,37.6,37.3,38.4,37.8,36.3,37.1,38.2,35.7,35.6,36.2,37.3,36.4,36.3,35.2,34.5,35.5,35.6,35.6,35.5,35.4,37.9,37.4,36.2,37.6,36.7,35.7,36.4,35.6,38.3,36.4,36.7,36.4,36.6,35.4,36.1,35.8,36.9,35.5,36.4,36.7,35.7,36.2,36.4,35.8,36,36.1,37.8,35.8,35.8,35.8,35.6],"freqrespi":[42,32,60,50,42,52,58,32,49,26,52,38,27,36,28,27,29,27,48,60,49,47,48,26,28,28,33,37,36,56,29,33,34,52,28,27,31,28,29,28,58,55,38,35,60,34,42,26,48,28,27,30,45,40,46,30,28,52,46,34,48,49,52,45,44,26,29,39,32,44,37,29,31,53,48,37,36,35,45,27,36,32,40,47,32,38,38,28,46,28,29,24,40,41,49,27,48,36,34,48,32,46,45,50,42,47,44,28,27,30,26,29,32,56,38,48,28,26,48,47,46,26,46,52,40,26,28,46,44,36,31,48,48,37,33,28,52,49,35,36,40,32,29,48,36,27,26,30,42,34],"viral_load":[0.5727,0.7362,0.5536,0.5536,0.7304,0.666,0.6681,0.2337,0.6529,0.4094,0.7244,0.7332,0.3898,0.7415,0.7115,0.5504,0.7301,0.1503,0.6674,0.6103,0.682,0.7205,0.6799,0.5943,0.3732,0.5943,0.8129,0.7211,0.7121,0.5853,0.7159,0.4142,0.6181,0.6466,0.7442,0.7535,0.6825,0.0853,0.1932,0.5298,0.7524,0.5619,0.6862,0.5218,0.2398,0.4034,0.2097,0.5507,0.7858,0.7635,0.7064,0.4005,0.6086,0.1727,0.6133,0.7202,0.3818,0.782,0.7658,0.3857,0.6899,0.1896,0.7552,0.1411,0.1974,0.4075,0.6326,0.5281,0.687,0.5185,0.6832,0.6018,0.5313,0.7133,0.7069,0.6021,0.0627,0.7154,0.4389,0.0855,0.7464,0.5808,0.6105,0.5086,0.4733,0.4716,0.5503,0.6731,0.735,0.5844,0.1549,0.4056,0.6148,0.6189,0.5969,0.492,0.4642,0.1447,0.0587,0.5279,0.416,0.3724,0.4633,0.4382,0.3694,0.4477,0.6169,0.644,0.1322,0.454,0.5347,0.5097,0.6363,0.4819,0.4641,0.6407,0.1222,0.6072,0.2952,0.0933,0.5496,0.0458,0.7031,0.3766,0.5018,0.2727,0.417,0.4439,0.4826,0.6845,0.3917,0.5595,0.4424,0.4662,0.5763,0.2567,0.3451,0.3422,0.4402,0.5114,0.5547,0.2627,0.4055,0.3707,0.2434,0.3319,0.3888,0.4467,0.5159,0.1245],"diarrhea_days":[3,4,2,3,0,0,2,3,2,7,7,6,4,6,6,3,4,1,3,3,7,3,3,3,5,6,6,3,5,0,1,4,0,0,3,6,2,4,3,4,4,0,4,3,0,0,2,6,0,5,3,2,2,3,3,4,3,3,4,3,0,1,5,4,6,3,3,3,0,3,0,3,2,3,4,4,6,3,3,4,4,3,0,4,0,3,1,5,3,3,0,3,4,1,3,0,3,0,3,3,2,2,6,5,1,3,5,2,4,0,4,4,3,2,2,4,2,4,4,0,0,2,3,2,2,2,2,4,2,0,0,4,1,4,0,6,5,3,1,0,3,0,3,4,2,4,6,6,5,6],"diarrhea_episodes":[6,5,3,5,3,5,4,4,7,3,7,5,6,6,5,6,4,9,5,8,6,4,7,7,3,6,6,4,4,3,6,10,4,3,11,3,5,11,7,12,4,5,7,7,8,4,4,4,6,7,11,10,7,3,3,10,6,4,6,8,8,3,3,6,3,7,7,6,4,3,3,6,5,3,6,8,3,7,3,7,6,8,4,9,7,3,8,3,3,5,4,5,4,6,4,5,6,3,6,4,4,4,7,5,3,8,4,7,8,4,3,9,8,5,6,7,3,6,7,4,4,6,6,4,3,9,4,5,6,3,3,4,6,7,5,3,4,4,8,5,3,3,3,3,5,9,10,11,4,10],"medication":[0,1,0,0,0,0,0,0,1,0,0,0,0,1,1,1,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,0,1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,0,1,0,0,0,1,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],"trad_medication":[1,1,0,1,0,0,0,0,0,0,1,1,1,1,1,1,0,0,1,1,1,0,0,1,1,1,1,0,1,0,1,1,0,0,0,1,1,1,1,1,1,0,1,1,0,1,0,1,0,1,0,0,0,1,0,0,0,0,1,1,0,0,1,0,1,1,0,1,0,0,0,1,0,0,1,1,0,1,1,0,0,1,0,0,1,0,0,1,0,0,0,1,1,0,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,0,0,1,1,1,1,1,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,1,1,1,1,1,1,1],"commune":["Golobougou","Kalaban-Coura","Kalabancoura","Quartier-Mali","Kabala","Kalabancoura","Baco-Djicoroni","Niamakoro-Courani","Sabalibougou","Tiebani","Kalabancoura","Yirimadio","Yirimadio","Yirimadio","Yirimadio","Yirimadio","Yirimadio","Yirimadio","Sabalibougou","Kalabancoura","Sabalibougou","Sabalibougou","Sabalibougou","Niamakoro","Yirimadio","Missabougou","Yirimadio","Niamakoro-Courani","Badalabougou","Kalabancoro","Yirimadio","Yirimadio","Daoudabougou","Baco-Djicoroni","Yirimadio","Missabougou","Yirimadio","Yirimadio","Missabougou","Yirimadio","Kalabancoro","Sabalibougou","Sabalibougou","Kalabancoro","Kalabancoro","Sabalibougou","Kalabancoura","Yirimadio","Kalabancoura","Missabougou","Yirimadio","Sabalibougou","Djicoroni-para","Yirimadio","Niamana","Yirimadio","Yirimadio","Kalabancoura","Kalabancoura","Gouana","Sabalibougou","Attbougou 1008","Sirakoro","Sirakoro","Sogoniko","Yirimadio","Yirimadio","Bozola","Sirakoro","Kalabancoura","Niamakoro","Yirimadio","Yirimadio","Daoudabougou","Kalabancoura","Sabalibougou","Niamana","Faladie Sokoro","Niamakoro","Yirimadio","Kabala","Sabalibougou","Sabalibougou","Sabalibougou","Faladie","Torokorobougou","Niamana","Banankoro","Yirimadio","Yirimadio","Yirimadio","Sabalibougou","Sabalibougou","Sabalibougou","Sirakoro Meguetana","Yirimadio","Sabalibougou","Niamakoro","Kalaban Nèrèkoro","Sokorodji","Niamakoro courani","Kalaban Nèrèkoro","Kalabancoro plateau","Sabalibougou","Sabalibougou","Sabalibougou","Senou","Yirimadio","Yirimadio","Yirimadio","Yirimadio","Sirakoro","Daoudabougou","Daoudabougou","Sabalibougou","Yirimadio","Sogoniko","Niamana","Niamakoro courani","Sabalibougou","Sabalibougou","Daoudabougou","Attbougou 320","Banankabougou","Niamakoro","Yirimadio","Yirimadio","Badalabougou","Kalabancoro","Kalabancoro","Yirimadio","Sabalibougou","Senou","Sabalibougou","Daoudabougou","Yirimadio","Toumikorobougou","Kabala","Sabalibougou","Sabalibougou","Niamakoro","Yirimadio","Yirimadio","Torokorobougou","Daoudabougou","Yirimadio","Yirimadio","Yirimadio","Gouana","Magnambougou"],"mother_education":[0,13,13,0,13,13,0,0,12,3,0,0,0,14,8,12,0,0,12,14,6,6,5,8,3,9,0,0,0,0,9,0,12,7,5,0,0,0,0,0,8,4,9,6,6,0,12,8,15,0,9,4,15,12,0,11,0,9,12,0,5,0,6,0,0,0,0,13,12,4,16,0,0,12,0,13,9,15,9,0,5,12,6,0,0,0,10,13,9,0,0,12,0,0,7,10,0,11,11,11,13,12,12,0,9,13,0,9,10,0,0,0,0,0,0,13,0,0,0,0,0,16,9,0,0,0,6,6,0,5,12,0,12,8,0,0,6,9,9,0,0,0,5,0,0,0,0,0,0,9],"father_education":[0,0,16,0,17,15,6,14,16,5,0,9,8,12,0,4,0,0,16,16,9,7,8,4,6,9,0,0,11,0,14,0,18,9,7,10,6,0,8,9,11,0,14,2,0,0,16,15,15,0,8,0,16,0,12,9,0,0,4,12,9,9,0,0,0,0,0,13,16,9,13,0,0,0,0,0,13,0,0,0,12,12,12,0,2,0,15,14,12,0,13,0,7,0,12,13,9,14,14,0,16,13,15,5,0,0,12,0,14,0,0,0,0,0,12,14,0,6,0,9,6,16,16,0,9,0,0,9,0,16,0,6,5,6,0,5,13,0,10,0,0,0,0,0,5,0,0,0,4,9],"household_size":[30,6,22,20,8,3,6,10,3,4,7,12,4,5,4,19,30,13,10,15,12,30,12,20,8,3,10,10,3,25,3,8,6,10,5,15,8,13,14,18,15,4,17,5,5,30,12,6,15,8,16,17,4,15,18,10,4,3,4,17,25,7,7,16,8,7,20,28,8,6,8,4,9,4,10,31,13,51,14,6,8,3,6,25,7,17,5,7,4,4,3,25,11,5,5,5,15,20,17,39,20,38,11,50,5,6,7,10,5,4,13,15,11,11,3,8,30,4,6,16,40,6,9,5,7,23,7,12,10,12,3,7,5,11,30,9,28,12,12,6,7,3,3,40,3,8,35,35,11,20]},"columns":[{"id":"n","name":"n","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"admit_date","name":"admit_date","type":"Date","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"sex","name":"sex","type":"character","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"age_months","name":"age_months","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"height_cm","name":"height_cm","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"muac_cm","name":"muac_cm","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"breastfeeding","name":"breastfeeding","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"vomit","name":"vomit","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"fever","name":"fever","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"bloody_stool","name":"bloody_stool","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"temp","name":"temp","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"freqrespi","name":"freqrespi","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"viral_load","name":"viral_load","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"diarrhea_days","name":"diarrhea_days","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"diarrhea_episodes","name":"diarrhea_episodes","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"medication","name":"medication","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"trad_medication","name":"trad_medication","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"commune","name":"commune","type":"character","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"mother_education","name":"mother_education","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"father_education","name":"father_education","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"},{"id":"household_size","name":"household_size","type":"numeric","html":true,"na":"NA","align":"left","className":"border-left"}],"resizable":true,"defaultPageSize":10,"highlight":true,"bordered":true,"striped":true,"nowrap":true,"theme":{"borderColor":"#e1f2f2","borderWidth":"1.5px","stripedColor":"#f2f7f7","cellPadding":"2px 5px 2px 5px"},"dataKey":"636df3be1bdaa02b6c79a23168ca2b66"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>We will begin by visualizing the relationship between the following two numerical variables:</p>
<ol type="1">
<li><code>age_months</code>: the patient’s <strong>age</strong> in months on the horizontal <strong>x</strong>-axis and</li>
<li><code>viral_load</code>: the patient’s <strong>viral load</strong> on the vertical <strong>y</strong>-axis</li>
</ol>
</section>
<section id="scatter-plots-via-geom_point" class="level2" data-number="18.4">
<h2 data-number="18.4" class="anchored" data-anchor-id="scatter-plots-via-geom_point"><span class="header-section-number">18.4</span> Scatter plots via <code>geom_point()</code></h2>
<p>We will explore relationships between some numerical variables in the <strong><code>malidd</code></strong> data frame.</p>
<p>We will now examine at and run the code that will create the desired scatter plot, while keeping in mind the GG framework. Let’s take a look at the code and break it down piece-by-piece.</p>
<p>Remember that we specify the first two GG layers as arguments (i.e., inputs) within the <code>ggplot()</code> function:</p>
<ol type="1">
<li>We provide the <code>malidd</code> data frame with the <strong><code>data</code></strong> argument, by inputting <strong><code>data = malidd</code></strong>.</li>
<li>We define the variables to be plotted in the <code>aes</code>thetics function of the <strong><code>mapping</code></strong> argument, by inputting <strong><code>mapping = aes(x = age_months, y = viral_load)</code></strong>. Specifically, the variable <code>age_months</code> is mapped to the <code>x</code> aesthetic, while the variable <code>viral_load</code> is mapped to the <code>y</code> aesthetic.</li>
</ol>
<p>We then add <strong>the <code>geom_*()</code> function</strong> on a new layer with a <strong><code>+</code></strong> sign. The geometric objects (i.e., shapes) needed for a scatter plot are points, so we add <strong><code>geom_point()</code></strong>.</p>
<p>After running the following lines of code, you’ll produce the scatter plot below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simple scatter plot of viral load vs age</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> malidd, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_months, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> viral_load)) <span class="sc">+</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_on_display_ls02_scatter_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This suggests that viral load generally <strong>decreases</strong> with age.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Practice">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Using the <code>malidd</code> data frame, create a scatter plot showing the relationship between age and height (<code>height_cm</code>).</li>
</ul>
</div>
</div>
</section>
<section id="aesthetic-modifications" class="level2" data-number="18.5">
<h2 data-number="18.5" class="anchored" data-anchor-id="aesthetic-modifications"><span class="header-section-number">18.5</span> Aesthetic modifications</h2>
<p>An aesthetic is a visual property of the geometric objects (<code>geom</code>s) in your plot. Aesthetics include things like the size, the shape, or the color of your points. You can display a point in different ways by changing the values of its aesthetic properties.</p>
<p>Remember, there are two methods for changing the aesthetic properties of your <code>geom</code>s (in this case, points).</p>
<ol type="1">
<li><p>You can convey information about your data by <em>mapping</em> the variables in your dataset to aesthetics in your plot. For this method, you use <code>aes()</code> in the <code>mapping</code> argument to associate the name of the aesthetic with a variable to display.</p></li>
<li><p>You can also <em>set</em> the aesthetic properties of your <code>geom</code>s <em>manually</em>. Here the aesthetic doesn’t convey information about a variable, but only changes the appearance of the plot. To change an aesthetic manually, you set the aesthetic by name as an argument of your <code>geom_*()</code> function; i.e.&nbsp;it goes <em>outside</em> of <code>aes()</code>.</p></li>
</ol>
<section id="mapping-data-to-aesthetics" class="level3" data-number="18.5.1">
<h3 data-number="18.5.1" class="anchored" data-anchor-id="mapping-data-to-aesthetics"><span class="header-section-number">18.5.1</span> Mapping data to aesthetics</h3>
<p>In addition to mapping variables to the <strong>x</strong> and <strong>y</strong> axes like with did above, variables can be mapped to the color, shape, size, opacity, and other visual characteristics of <code>geom</code>s. This allows groups of observations to be superimposed in a single graph.</p>
<p>To map a variable to an aesthetic, associate the name of the aesthetic to the name of the variable inside <code>aes()</code>. This way, we can visualize a third variable to our simple two dimensional scatter plot by mapping it to a new aesthetic.</p>
<p>For example, let’s map <code>height_cm</code> to the colors of our points, to show us how height varies with age and viral load:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> malidd, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_months, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> viral_load)) <span class="sc">+</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> height_cm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_on_display_ls02_scatter_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We see that {ggplot2} has automatically assigned the values of our variable to an aesthetic, a process known as <strong>scaling</strong>. {ggplot2} will also add a legend that explains which levels correspond to which values.</p>
<p>Here the points are colored by different shades of the same blue hue, with darker colors representing lower values.</p>
<p>This shows us that height increases with age, as expected.</p>
<p>Instead of a continuous variable like <code>height_cm</code>, we can also map a binary variable like <code>breastfeeding</code>, to show us the which children are breastfed and which ones are not:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> malidd, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_months, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> viral_load)) <span class="sc">+</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> breastfeeding))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_on_display_ls02_scatter_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We get the same gradual color scaling like with did with height. This communicates a continuum of values, rather than the two distinct values in our variable - 0 or 1.</p>
<p>This is because of the data class of the <code>breastfeeding</code> variable in <code>malidd</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(malidd<span class="sc">$</span>breastfeeding)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
</div>
<p>But even though binary variables are numerical, they represent two <em>discrete</em> possibilities. So the continuous color scaling in the plot above is not ideal.</p>
<p>In cases like this, we add the function <code>factor()</code> around the <code>breastfeeding</code> variable to tell <code>ggplot()</code> to treat the variable as a factor. Let’s see what happens when we do that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> malidd, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_months, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> viral_load)) <span class="sc">+</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(breastfeeding)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_on_display_ls02_scatter_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>When the variable is treated like a factor, the colors chosen are clearly distinguishable. With factors, {ggplot2} will automatically assign a unique level of the aesthetic (here a unique color) to each unique value of the variable. (this is what happened with the <code>region</code> variable of the <code>nigerm</code> dataframe that we use in the last lesson)</p>
<p>This plot reveals a clear relationship between age and breastfeeding, as we might expect. Children are likely to stop breastfeeding around 20 months of age. In this study, no child at or above 25 months was being breastfed.</p>
<p>Adding colors to the scatter plot allowed us to visualize a <strong>third variable</strong> in addition to the relationship between age and viral load. The third variable could be either discrete or continuous.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Practice">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Using the <code>malidd</code> data frame, create a scatter plot showing the relationship between age and viral load, and map a third variable, <code>freqrespi</code>, to color:</p></li>
<li><p>Create the same age vs.&nbsp;height scatterplot again, but this time, map the binary variable <code>fever</code> to the color of the points. Keep in mind that <code>fever</code> should be treated as a factor.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Type and view your answer:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>age_height_fever <span class="ot">&lt;-</span>  <span class="st">"YOUR ANSWER HERE"</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>age_height_fever</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="setting-fixed-aesthetics" class="level3" data-number="18.5.2">
<h3 data-number="18.5.2" class="anchored" data-anchor-id="setting-fixed-aesthetics"><span class="header-section-number">18.5.2</span> Setting fixed aesthetics</h3>
<p>Aesthetic arguments set to a fixed value will be static, and the visual effect is not data-dependent. To add a fixed aesthetic, we add as a direct argument of the <code>geom_*()</code> function; i.e., it goes <em>outside</em> of <code>mapping = aes()</code>.</p>
<p>Let’s look at some of the aesthetic arguments we can place directly within <code>geom_point()</code> to make visual changes to the points in our scatter plot:</p>
<ul>
<li><p><code>color</code> - point color or point outline color</p></li>
<li><p><code>size</code> - point size</p></li>
<li><p><code>alpha</code> - point opacity</p></li>
<li><p><code>shape</code> - point shape</p></li>
<li><p><code>fill</code> - point fill color (only applies if the point has an outline)</p></li>
</ul>
<p>To use these options to create a more attractive scatter plot, you’ll need to pick a value for each argument that makes sense for that aesthetic, as shown in the examples below.</p>
<section id="changing-color-size-and-alpha" class="level4" data-number="18.5.2.1">
<h4 data-number="18.5.2.1" class="anchored" data-anchor-id="changing-color-size-and-alpha"><span class="header-section-number">18.5.2.1</span> Changing <code>color</code>, <code>size</code> and <code>alpha</code></h4>
<p>Let’s change the color of the points to a fixed value by setting the <code>color</code> argument directly within <code>geom_point()</code>. The color we choose must be a character string that R recognizes as a color. Here we will set the point colors to steel blue:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">##  Modify original scatter plot by setting `color = "steelblue"`</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> malidd, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_months, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> viral_load)) <span class="sc">+</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>)       <span class="co"># set color</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_on_display_ls02_scatter_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In addition to changing the default color, now we will modify the <code>size</code> aesthetic of the points by assigning it to a fixed number (in millimeters). The default size is 1 mm, so let’s chose a larger value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">##  Set size to 2 mm by ading `size = 2`</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> malidd, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_months, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> viral_load)) <span class="sc">+</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>,       <span class="co"># set color</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>)                  <span class="co"># set size (mm)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_on_display_ls02_scatter_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The <code>alpha</code> aesthetic controls the level of opacity of <code>geom</code>s. <code>alpha</code> is also numerical, and ranges from 0 (completely transparent) to the default of 1 (completely opaque). Let’s make our points more transparent by reducing the opacity:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">##  Set opacity to 75% by adding `alpha = 0.75`</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> malidd, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_months, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> viral_load)) <span class="sc">+</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>,       <span class="co"># set color</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>,                  <span class="co"># set size (mm)</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.75</span>)              <span class="co"># set level of opacity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_on_display_ls02_scatter_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now we can see where multiple points overlap. This is a useful parameter for scatter plots where there is <strong>overplotting</strong>.</p>
<p>Remember, changing the color, size, or opacity of our points here is not conveying any information in the data - they are design choices we make to create prettier plots.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Practice">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Create a scatter plot with the same variables as the previous example, but change the color of the points to <code>cornflowerblue</code>, increase the size of points to 3 mm and set the opacity to 60%.</li>
</ul>
</div>
</div>
</section>
<section id="changing-shape-and-fill" class="level4" data-number="18.5.2.2">
<h4 data-number="18.5.2.2" class="anchored" data-anchor-id="changing-shape-and-fill"><span class="header-section-number">18.5.2.2</span> Changing <code>shape</code> and <code>fill</code></h4>
<p>We can change the appearance of points in a scatter plot with the <code>shape</code> aesthetic.</p>
<p>To change the shape of your <code>geom</code>s to a fixed value, set <code>shape</code> equal to a number corresponding to your desired shape.</p>
<p>{ggplot2} will accept the following numbers:</p>
<p><img src="images/ggplot_shapes.png" class="img-fluid" width="400" alt="Numerical coding of different shapes in {ggplot2}"> Notice that some of the shapes are filled in with red. This indicates that objects 21-24 are sensitive to both <code>color</code> and <code>fill</code>, but the others are only sensitive to color.</p>
<p>First let’s modify our original scatterplot by changing the shapes to a something that can be filled in:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Set shape to fillable circles by adding `shape = 21`</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> malidd, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_months, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> viral_load)) <span class="sc">+</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>)                <span class="co"># set shapes to display</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_on_display_ls02_scatter_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Fillable shapes can have different colors for the outline and interior. Changing the <code>color</code> aesthetic will only change the outline of our points:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Set outline color of the shapes by adding `color = cyan4`</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> malidd, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_months, </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> viral_load)) <span class="sc">+</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>,                <span class="co"># set shapes to display</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"cyan4"</span>)           <span class="co"># set outline color</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_on_display_ls02_scatter_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now let’s fill in the points:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Set interior color of the shapes by adding `fill = "seagreen"` </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> malidd, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_months, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> viral_load)) <span class="sc">+</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>,                <span class="co"># set shapes to display</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"cyan4"</span>,           <span class="co"># set outline color</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">"seagreen"</span>)         <span class="co"># set fill color</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_on_display_ls02_scatter_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can improve the readability by increasing size and reducing opcaity with <code>size</code> and <code>alpha</code>, like we did before:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> malidd, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_months, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> viral_load)) <span class="sc">+</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>,                <span class="co"># set shapes to display</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"cyan4"</span>,           <span class="co"># set outline color</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">"seagreen"</span>,         <span class="co"># set fill color</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>,                  <span class="co"># set size (mm)</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.75</span>)              <span class="co"># set level of opacity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data_on_display_ls02_scatter_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="adding-a-trend-line" class="level2" data-number="18.6">
<h2 data-number="18.6" class="anchored" data-anchor-id="adding-a-trend-line"><span class="header-section-number">18.6</span> Adding a trend line</h2>
<p>It can be hard to view relationships or trends with just points alone. Often we want to add a smoothing line in order to see what the trends look like. This can be especially helpful when trying to understand regressions.</p>
<p>To get a better idea of the relationship between these to variables, we can add a trend line (also known as a best fit line or a smoothing line).</p>
<p>To do this, we add the function <code>geom_smooth()</code> to our scatter plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> malidd, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_months, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> viral_load)) <span class="sc">+</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_on_display_ls02_scatter_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The smoothing line comes after our points an another geometric layer added onto our plot.</p>
<p>The default smoothing function used in this scatter plot is “loess” which stands for for <strong>l</strong>ocally <strong>w</strong>eighted <strong>scatter plot</strong> <strong>s</strong>moothing. Loess smoothing is a process used by many statistical softwares. In {ggplot2} this generally should be done when you have less than 1000 points, otherwise it can be time consuming.</p>
<p>Many other smoothing functions can also be used in <code>geom_smooth()</code>.</p>
<p>Let’s request a linear regression method. This time we will use a generalized linear model by setting the <code>method</code> argument inside <code>geom_smooth()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Change to a linear smoothing function with `method = "glm"`</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> malidd, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_months, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> viral_load)) <span class="sc">+</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_on_display_ls02_scatter_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>By default, 95% confidence limits for these lines are displayed.</p>
<p>You can suppress the confidence bands by including the argument <code>se = FALSE</code> inside <code>geom_smooth()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Remove confidence interval bands by adding `se = FALSE`</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> malidd, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_months, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> viral_load)) <span class="sc">+</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_on_display_ls02_scatter_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In addition to changing the method, let’s add the <code>color</code> argument inside <code>geom_smooth()</code> to change the color of the line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Change the color of the trend line by adding `color = "darkred"`</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> malidd, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_months, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> viral_load)) <span class="sc">+</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"darkred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_on_display_ls02_scatter_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This linear regression concurs with what we initially observed in the first scatter plot. A <em>negative relationship</em> exists between <code>age_months</code> and <code>viral_load</code>: as age increases, viral load tends to decrease.</p>
<p>Let’s add a third variable from the <code>malidd</code> dataset called<code>vomit</code>. This which is a binary variable that records whether or not the patient vomited. We will add the <code>vomit</code> variable to the plot by mapping it to the color aesthetic. We will again change the smoothing method to generalized additive model (“<code>gam</code>”) and make some aesthetic modifications to the line in the <code>geom_smooth()</code> layer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> malidd, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_months, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> viral_load)) <span class="sc">+</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(vomit))) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"gam"</span>, </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">1.5</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"darkgray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="data_on_display_ls02_scatter_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Observe the distribution of blue points (children who vomited) compared to red points (children who did not vomit). The blue points mostly occur above the trend line. This shows that higher viral loads were not only associated with younger children, but that children with higher viral loads were more likely to exhibit symptoms of vomiting.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Practice">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Create a scatter plot with the <code>age_months</code> and <code>height_cm</code> variables. Set the color of the points to “steelblue”, the size to 2.5mm, the opacity to 80%. Then add trend line with the smoothing method “lm” (linear model). To make the trend line stand out, set its color to “indianred3”.</p></li>
<li><p>Recreate the plot you made in the previous question, but this time adapt the code to change the shape of the points to tilted rectangles (number 23), and add the body temperature variable (<code>temp</code>) by <strong>mapping</strong> it to fill color of the points.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Type and view your answer:</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>age_height_3 <span class="ot">&lt;-</span>  <span class="st">"YOUR ANSWER HERE"</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>age_height_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="summary" class="level2" data-number="18.7">
<h2 data-number="18.7" class="anchored" data-anchor-id="summary"><span class="header-section-number">18.7</span> Summary</h2>
<p>Scatter plots display the relationship between two numerical variables.</p>
<p>With medium to large datasets, you may need to play around with the different modifications to scatter plots we saw such as adding trend lines, changing the color, size, shape, fill, or opacity of the points. This tweaking is often a fun part of data visualization, since you’ll have the chance to see different relationships emerge as you tinker with your plots.</p>
</section>
<section id="references" class="level2 unlisted unnumbered">
<h2 class="unlisted unnumbered anchored" data-anchor-id="references">References</h2>
<p>Some material in this lesson was adapted from the following sources:</p>
<ul>
<li>Ismay, Chester, and Albert Y. Kim. 2022. <em>A ModernDive into R and the Tidyverse</em>. <a href="https://moderndive.com/" class="uri">https://moderndive.com/</a>.</li>
<li>Kabacoff, Rob. 2020. <em>Data Visualization with R</em>. <a href="https://rkabacoff.github.io/datavis/" class="uri">https://rkabacoff.github.io/datavis/</a>.</li>
<li>Giroux-Bougard, Xavier, Maxwell Farrell, Amanda Winegardner, Étienne Low-Decarie and Monica Granados. 2020. <em>Workshop 3: Introduction to Data Visualisation with {ggplot2}</em>. <a href="http://r.qcbs.ca/workshop03/book-en/" class="uri">http://r.qcbs.ca/workshop03/book-en/</a>.</li>
</ul>
</section>
<section id="solutions" class="level2" data-number="18.8">
<h2 data-number="18.8" class="anchored" data-anchor-id="solutions"><span class="header-section-number">18.8</span> Solutions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.SOLUTION_age_height</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ggplot(data = malidd,
             mapping = aes(x = age_months, 
                           y = height_cm)) +
      geom_point()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.SOLUTION_age_height_respi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ggplot(data = malidd, 
             mapping = aes(x = age_months, 
                           y = viral_load)) + 
      geom_point(mapping = aes(color = freqrespi))</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.SOLUTION_age_viral_respi</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ggplot(data = malidd, 
             mapping = aes(x = age_months, 
                           y = viral_load)) + 
      geom_point(mapping = aes(color = freqrespi))</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.SOLUTION_age_height_fever</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ggplot(data = malidd, 
             mapping = aes(x = age_months, 
                           y = height_cm)) + 
      geom_point(mapping = aes(color = factor(fever)))</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.SOLUTION_age_viral_blue</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ggplot(data = malidd, 
             mapping = aes(x = age_months, 
                           y = viral_load)) + 
      geom_point(color = "cornflowerblue",
                 size = 3,
                 alpha = 0.6)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.SOLUTION_age_height_2</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ggplot(data = malidd, 
          mapping = aes(x = age_months, 
                        y = height_cm)) + 
      geom_point(color = "steelblue",
                 size = 2.5,
                 alpha = 0.8) +
      geom_smooth(method = "lm", color = "indianred3")</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.SOLUTION_age_height_3</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ggplot(data = malidd, 
          mapping = aes(x = age_months, y = height_cm)) + 
      geom_point(color = "steelblue",
                 size = 2.5,
                 alpha = 0.8,
                 shape = 23,
                 mapping = aes(fill = temp)) +
      geom_smooth(method = "lm", color = "indianred3")</code></pre>
</div>
</div>
<p>This work is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/"> Creative Commons Attribution Share Alike</a> license. <a class="license" rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">     <img alt="Creative Commons License" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data_on_display_ls01_gg_intro.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Intro to ggplot2</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./data_on_display_ls03_line_graphs.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Lines, scales, and labels</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Book created by <a href="https://thegraphcourses.org/">The GRAPH Courses</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">For a PDF copy, please visit this <a href="https://raw.githubusercontent.com/the-graph-courses/idar_book/main/pdf/Introduction-to-Data-Analysis-with-R.pdf">page</a>.</div>
  </div>
</footer>



</body></html>